<!DOCTYPE html>
<html lang="{{ app.request.locale|default('en') }}" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    
    {# SEO Meta Tags #}
    <title>{% block title %}PrettiOps - Beautiful Code Emails{% endblock %}</title>
    <meta name="description" content="{% block description %}Transform your technical emails with beautiful code snippets, syntax highlighting, and professional formatting.{% endblock %}">
    <meta name="keywords" content="{% block keywords %}code email, syntax highlighting, developer tools, technical communication, code formatting{% endblock %}">
    
    {# Open Graph Meta Tags #}
    <meta property="og:title" content="{% block og_title %}{{ block('title') }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ block('description') }}{% endblock %}">
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{% block og_url %}{{ app.request.uri }}{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{{ absolute_url(asset('images/og-image.png')) }}{% endblock %}">
    <meta property="og:site_name" content="PrettiOps">
    <meta property="og:locale" content="{{ app.request.locale|default('en_US') }}">
    
    {# Twitter Card Meta Tags #}
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ block('og_title') }}">
    <meta name="twitter:description" content="{{ block('og_description') }}">
    <meta name="twitter:image" content="{{ block('og_image') }}">
    
    {# PWA Meta Tags #}
    <meta name="theme-color" content="#6f00ff" id="theme-color-meta">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="PrettiOps">
    
    {# Preconnect to external domains #}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    {# Favicon #}
    <link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ asset('images/favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ asset('images/favicon-16x16.png') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ asset('images/apple-touch-icon.png') }}">
    <link rel="manifest" href="{{ asset('manifest.json') }}">
    
    {# Fonts - Using design system fonts #}
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=Inter:wght@400;500;600&family=Fira+Code:wght@400;500;600&display=swap" rel="stylesheet">
    
    {# CSS Assets #}
    {% block stylesheets %}
        {{ encore_entry_link_tags('app') }}
    {% endblock %}
    
    {# CSRF Token for AJAX requests #}
    {% if csrf_token is defined %}
        <meta name="csrf-token" content="{{ csrf_token('authenticate') }}">
    {% endif %}
    
    {# Additional meta tags #}
    {% block extra_meta %}{% endblock %}
    
    {# Structured Data #}
    {% block structured_data %}
        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebApplication",
            "name": "PrettiOps",
            "description": "Beautiful code emails for developers",
            "url": "{{ app.request.schemeAndHttpHost }}",
            "applicationCategory": "DeveloperApplication",
            "operatingSystem": "Web Browser",
            "offers": {
                "@type": "Offer",
                "price": "0",
                "priceCurrency": "USD"
            }
        }
        </script>
    {% endblock %}
</head>
<body 
    class="font-body text-gray-700 bg-gray-50 min-h-screen flex flex-col {% block body_class %}{% endblock %}"
    data-controller="{% block body_controllers %}theme{% endblock %}"
    {% block body_attributes %}{% endblock %}
>
    {# Skip to main content link for accessibility #}
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 z-50 bg-purple-600 text-white px-4 py-2 rounded-md skip-to-main">
        Skip to main content
    </a>
    
    {# Background pattern (subtle grid) #}
    <div class="fixed inset-0 z-0 opacity-20 pointer-events-none">
        <div class="w-full h-full" style="background-image: linear-gradient(rgba(111, 0, 255, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(111, 0, 255, 0.1) 1px, transparent 1px); background-size: 20px 20px;"></div>
    </div>
    
    {# Navigation #}
    {% block navigation %}
        {% if not hide_navigation|default(false) %}
            {% include 'components/_navbar.html.twig' %}
        {% endif %}
    {% endblock %}
    
    {# Main Content #}
    <main id="main-content" class="flex-1 relative z-10 {% block main_class %}{% endblock %}" role="main">
        {# Flash Messages #}
        {% if not hide_flash_messages|default(false) %}
            {% include 'components/_flash_messages.html.twig' %}
        {% endif %}
        
        {# Page Content #}
        {% block content %}
            {% block body %}{% endblock %}
        {% endblock %}
    </main>
    
    {# Footer #}
    {% block footer %}
        {% if not hide_footer|default(false) %}
            {% include 'components/_footer.html.twig' %}
        {% endif %}
    {% endblock %}
    
    {# Loading Overlay #}
    <div id="loading-overlay" class="hidden fixed inset-0 z-50 bg-gray-900 bg-opacity-50 flex items-center justify-center">
        <div class="bg-white rounded-lg p-6 flex items-center gap-3">
            <div class="loading-spinner"></div>
            <span class="text-gray-700 font-medium">Loading...</span>
        </div>
    </div>
    
    {# JavaScript Assets #}
    {% block javascripts %}
        {{ encore_entry_script_tags('app') }}
        {% if block('page_scripts') is defined %}
            {% block page_scripts %}{% endblock %}
        {% endif %}
    {% endblock %}
    
    {# Turbo Drive Configuration #}
    <script>
        // Configure Turbo for better UX
        document.addEventListener('turbo:before-visit', function() {
            document.getElementById('loading-overlay').classList.remove('hidden');
        });
        
        document.addEventListener('turbo:load', function() {
            document.getElementById('loading-overlay').classList.add('hidden');
        });
        
        // Error handling
        document.addEventListener('turbo:fetch-request-error', function(event) {
            document.getElementById('loading-overlay').classList.add('hidden');
            
            if (window.notificationManager) {
                window.notificationManager.error('Network error occurred. Please check your connection.');
            }
        });
        
        // Handle form submissions with better UX
        document.addEventListener('turbo:submit-start', function(event) {
            const form = event.target;
            const submitButton = form.querySelector('button[type="submit"]');
            
            if (submitButton) {
                submitButton.disabled = true;
                submitButton.classList.add('loading');
            }
        });
        
        document.addEventListener('turbo:submit-end', function(event) {
            const form = event.target;
            const submitButton = form.querySelector('button[type="submit"]');
            
            if (submitButton) {
                submitButton.disabled = false;
                submitButton.classList.remove('loading');
            }
        });
    </script>
    
    {# Analytics and tracking #}
    {% block analytics %}
        {# Add analytics code here when ready #}
    {% endblock %}
</body>
</html>