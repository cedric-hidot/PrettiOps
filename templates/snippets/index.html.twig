{% extends 'base.html.twig' %}

{% block title %}My Snippets - PrettiOps{% endblock %}

{% block body_controllers %}{{ parent() }} snippets snippet collaboration integration{% endblock %}

{% block body %}
<div class="max-w-7xl mx-auto px-4 py-8" data-controller="snippets">
    
    {# Header Section #}
    <div class="mb-8">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">My Code Snippets</h1>
                <p class="text-gray-600">Manage your code snippets, share with teams, and collaborate efficiently.</p>
            </div>
            
            <div class="flex gap-3 mt-4 md:mt-0">
                <a href="{{ path('app_editor') }}" class="inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                    </svg>
                    New Snippet
                </a>
                
                <button class="inline-flex items-center px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors"
                        data-action="click->snippets#importSnippets">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                    </svg>
                    Import
                </button>
            </div>
        </div>
    </div>
    
    {# Filters and Search #}
    <div class="bg-white rounded-xl border border-gray-200 p-6 mb-8">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            {# Search #}
            <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-2">Search snippets</label>
                <div class="relative">
                    <input type="text" 
                           data-snippets-target="searchInput"
                           data-action="input->snippets#search"
                           placeholder="Search by title, content, or tags..."
                           class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                    <svg class="absolute left-3 top-2.5 h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
            </div>
            
            {# Language Filter #}
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Language</label>
                <select data-snippets-target="languageFilter"
                        data-action="change->snippets#filterByLanguage"
                        class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                    <option value="">All Languages</option>
                    <option value="javascript">JavaScript</option>
                    <option value="python">Python</option>
                    <option value="php">PHP</option>
                    <option value="java">Java</option>
                    <option value="typescript">TypeScript</option>
                    <option value="go">Go</option>
                    <option value="rust">Rust</option>
                    <option value="sql">SQL</option>
                </select>
            </div>
            
            {# Sort Options #}
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Sort by</label>
                <select data-snippets-target="sortFilter"
                        data-action="change->snippets#sortSnippets"
                        class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                    <option value="recent">Most Recent</option>
                    <option value="name">Name A-Z</option>
                    <option value="popular">Most Popular</option>
                    <option value="language">Language</option>
                </select>
            </div>
        </div>
    </div>
    
    {# Snippets Grid #}
    <div data-snippets-target="grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        
        {# Sample Snippet Cards (replace with real data) #}
        {% for i in 1..6 %}
        <div class="snippet-card bg-white rounded-xl border border-gray-200 hover:border-purple-200 transition-all duration-200 hover:shadow-lg group overflow-hidden"
             data-snippets-target="card"
             data-language="{{ ['javascript', 'python', 'php', 'go', 'typescript', 'java'][loop.index0] }}"
             data-created="{{ 'now'|date_modify('-' ~ (i * 2) ~ ' days')|date('c') }}">
            
            {# Card Header #}
            <div class="p-4 border-b border-gray-100 bg-gray-50">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-{{ ['yellow', 'green', 'blue', 'red', 'purple', 'indigo'][loop.index0] }}-500"></div>
                        <span class="text-sm font-medium text-gray-600 capitalize">{{ ['JavaScript', 'Python', 'PHP', 'Go', 'TypeScript', 'Java'][loop.index0] }}</span>
                    </div>
                    
                    {# Actions Dropdown #}
                    <div class="relative" data-controller="dropdown">
                        <button class="p-1 hover:bg-gray-200 rounded transition-colors"
                                data-action="click->dropdown#toggle">
                            <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path>
                            </svg>
                        </button>
                        
                        <div data-dropdown-target="menu" 
                             class="absolute right-0 top-full mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg hidden z-10">
                            <div class="py-1">
                                <button class="w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2"
                                        data-action="click->snippets#editSnippet"
                                        data-snippet-id="{{ i }}">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                    </svg>
                                    Edit
                                </button>
                                <button class="w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2"
                                        data-action="click->snippets#copySnippet"
                                        data-snippet-id="{{ i }}">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                                    </svg>
                                    Copy
                                </button>
                                <button class="w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2"
                                        data-action="click->snippets#shareSnippet"
                                        data-snippet-id="{{ i }}">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
                                    </svg>
                                    Share
                                </button>
                                <hr class="my-1">
                                <button class="w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2"
                                        data-action="click->snippets#deleteSnippet"
                                        data-snippet-id="{{ i }}">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                    </svg>
                                    Delete
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            {# Code Preview #}
            <div class="p-4 bg-gray-900 text-gray-100 font-mono text-sm overflow-hidden">
                <div class="flex items-center gap-2 mb-3">
                    <div class="flex gap-1">
                        <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                        <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                        <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                    </div>
                    <span class="text-xs text-gray-400">{{ ['api.js', 'utils.py', 'config.php', 'main.go', 'types.ts', 'Service.java'][loop.index0] }}</span>
                </div>
                
                <pre class="text-xs leading-relaxed text-gray-300 max-h-32 overflow-hidden">{% if loop.index == 1 %}// Authentication API helper
async function authenticateUser(credentials) {
  try {
    const response = await fetch('/api/auth', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(credentials)
    });
    return await response.json();
  } catch (error) {
    console.error('Auth failed:', error);
  }
}{% elseif loop.index == 2 %}def calculate_metrics(data):
    """Calculate performance metrics from dataset"""
    total = sum(data)
    average = total / len(data)
    
    return {
        'total': total,
        'average': round(average, 2),
        'max': max(data),
        'min': min(data)
    }{% else %}// Sample code snippet {{ loop.index }}
function processData(input) {
  const result = input
    .filter(item => item.active)
    .map(item => ({
      id: item.id,
      name: item.name
    }));
  return result;
}{% endif %}</pre>
                
                <div class="mt-2 text-xs text-gray-500">
                    {{ random(['15', '23', '8', '31', '19', '42']) }} lines • Created {{ ['2', '4', '7', '12', '18', '25'][loop.index0] }} days ago
                </div>
            </div>
            
            {# Card Footer #}
            <div class="p-4 border-t border-gray-100">
                <h3 class="font-semibold text-gray-900 mb-1">{{ ['User Authentication', 'Data Metrics Calculator', 'Config Parser', 'HTTP Server', 'Type Definitions', 'Email Service'][loop.index0] }}</h3>
                <p class="text-sm text-gray-600 mb-3">{{ ['REST API authentication with error handling', 'Performance metrics calculation utility', 'Configuration file parser with validation', 'Basic HTTP server implementation', 'TypeScript interface definitions', 'Email sending service with templates'][loop.index0] }}</p>
                
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2 text-xs text-gray-500">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                        </svg>
                        {{ random(['24', '67', '15', '89', '33', '156']) }} views
                    </div>
                    
                    <div class="flex items-center gap-1">
                        {% for tag in [['auth', 'api'], ['python', 'data'], ['php', 'config'], ['golang', 'server'], ['typescript', 'types'], ['java', 'email']][loop.index0] %}
                        <span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded">{{ tag }}</span>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
        
    </div>
    
    {# Load More Button #}
    <div class="text-center mt-8">
        <button class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors"
                data-action="click->snippets#loadMore">
            Load More Snippets
        </button>
    </div>
    
    {# Empty State (hidden by default) #}
    <div data-snippets-target="emptyState" class="hidden text-center py-16">
        <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
        </svg>
        <h3 class="text-xl font-medium text-gray-900 mb-2">No snippets found</h3>
        <p class="text-gray-600 mb-6">Create your first code snippet to get started.</p>
        <a href="{{ path('app_editor') }}" class="inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            Create Snippet
        </a>
    </div>
</div>
{% endblock %}

{% block page_scripts %}
    {{ encore_entry_script_tags('app') }}
{% endblock %}